<div class="resolicion">
  <div class="destock">
    <nav class="navbar navbar-expand-lg colorprimary" >
      <div class="container-fluid" style="align-items: center;">
        <a class="navbar-brand colorprimary" style="padding-left:45%;"  ><h3 style="padding-left:50%;">Usuarios</h3></a>
      </div> 
      <div style="position: absolute; left:75%;">
        <button style="padding-right:100px" type="button" class="dropdown-item btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor" color="#fff" class="bi bi-h-circle" viewBox="0 0 16 16">
            <path d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8Zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-5-3.998V12H9.67V8.455H6.33V12H5V4.002h1.33v3.322h3.34V4.002H11Z"/>
          </svg>        
        </button>
        <ul class="dropdown-menu">
          <li><button class="dropdown-item" (click)="helpRegistro()">Registrar Usuario</button></li>  
          <li><button class="dropdown-item" (click)="helpEditar()">Editar Usuario</button></li>  
          <li><button class="dropdown-item" (click)="helpEliminar()">Eliminar Usuario</button></li>           
        </ul>
      </div>  
    </nav>
    <div style="padding-left: 1%; padding-right: 1%;">
      <div class="col-12 row mb-4">
        <div class="col-9"></div>
        <!--boton agregar viaje-->
        <div class="col-3 row">
          <div class="col-12" *ngIf="permisos == 'D' || permisos == 'C'">
            <button type="button" class="btn col-10 colorprimary mt-4" type="button" style="min-width:80px; color:white; background:#0146af" (click)="registrarUsusario()">Registrar</button>
          </div>
        </div>     
      </div>
      <div class="col-12 row"> 
        <div class="col-11" align="end">
          <button class="btn" (click)="mostrarfiltro()">
            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
                <path d="M747 4469 c-162 -38 -297 -178 -337 -348 -24 -103 4 -245 68 -339 15 -22 363 -410 774 -862 l748 -822 2 -798 c3 -789 3 -799 24 -826 49 -67 130 -91 195 -60 19 9 221 166 449 349 299 239 420 342 432 367 16 32 18 77 18 502 l0 466 663 729 c364 401 707 778 761 838 110 122 151 194 169 300 29 171 -60 360 -214 452 -112 67 11 63 -1944 62 -1002 -1 -1786 -5 -1808 -10z m3580 -326 c50 -23 80 -91 64 -143 -8 -27 -204 -250 -782 -886 -424 -467 -778 -860 -788 -874 -14 -21 -17 -80 -21 -494 l-5 -469 -230 -188 c-126 -103 -233 -188 -237 -188 -5 -1 -8 290 -8 647 -1 591 -2 650 -18 678 -9 18 -361 411 -782 874 -421 463 -773 856 -782 873 -34 60 -15 131 45 167 31 20 64 20 1770 20 1607 0 1742 -1 1774 -17z"/>
              </g>
            </svg>
          </button>
        </div>
      </div>  
      <!--filtros-->
      <div style="padding-left:7%; padding-right: 7%;" *ngIf="mostrar == false">
        <form class="was-validated" [formGroup]="reactiveForm" class="card">
          <div class="row" style="justify-content: center; padding-left:4%; padding-right: 4%;">
            <div class="mb-4 col-3 mt-3" style="text-align: center;">
              <label class="col-12" for="fReferencia" >Estatus</label>
              <select (click)="filtro(reactiveForm.value.estatus)" [(ngModel)]="reactiveForm.value.estatus" name="select" formControlName="estatus">
                <option value=""selected></option>
                <option value="Activo">Activo</option>
                <option value="Eliminado">Eliminado</option>
                <option value="Cancelado">Cancelado</option>
                <option value="Terminado">Terminado</option>
                <option value="En proceso">En proceso</option>
              </select>
            </div>
            <div class="mb-4 col-3 mt-3">
              <label for="fReferencia">RFC</label>
              <input (keyup)="filtro(reactiveForm.value.trfc)" [(ngModel)]="reactiveForm.value.trfc" formControlName="trfc" class="form-control" id="trfc" placeholder="RFC" >
            </div>
            <div class="mb-4 col-3 mt-3">
              <label  >Nombre</label>
              <input (keyup)="filtro(reactiveForm.value.Nombre)" [(ngModel)]="reactiveForm.value.Nombre" formControlName="Nombre" class="form-control" id="Nombre" placeholder="Nombre" >
            </div>
          </div>
        </form>
      </div> 
    </div>
    <div class="row col-lg-12 text-center mt-4" style="margin-left: 0px;">
      <label class="col-lg-12"><strong class="labelPrimary">Registros encontrados: {{dataSource ?  dataSource.length : 0}}</strong></label>
    </div>
    <div class="container">
      <div *ngIf="dataSource" style="overflow-y: auto; min-height: 350px;">  
        <table matSort mat-table [dataSource]="dataSource"  class="mt-5 container table table-striped table-bordered full-data-table" >
          <ng-container matColumnDef="E" >
            <th mat-header-cell *matHeaderCellDef style="text-align: center;" class="colorprimary"><h6 style="position:relative; top:-9px;">E</h6>  </th>
            <td mat-cell *matCellDef="let element" style="text-align: center;"> 
              <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                  <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                </svg>
              </button>
              <ul class="dropdown-menu">
                <li>
                  <button class="dropdown-item" (click)="DetalleViaje(element!.ecodUsuarios)">Ver detalles
                  </button>
                  <button class="dropdown-item" *ngIf="permisos == 'D' || permisos == 'C'" [disabled]="element!.estatus === 'Eliminado'" class="dropdown-item" (click)="REdireccionarEditarUsurio(element!.ecodUsuarios)">Editar</button>
                  <button class="dropdown-item" *ngIf="permisos == 'D'" [disabled]="element!.estatus === 'Eliminado'" (click)="REdireccionarEliminars(element!.ecodUsuarios)">Eliminar</button>
                </li>          
              </ul>
            </td>
          </ng-container>
         
          <ng-container matColumnDef="estatus" >
            <th mat-header-cell *matHeaderCellDef style="text-align: center;" class="colorprimary"><h6 style="position:relative; top:-9px;">Estatus</h6> </th>
            <td mat-cell *matCellDef="let element" style="text-align: center; padding: 10px;"> 
              {{element.estatus}} 
            </td>
          </ng-container>
          <ng-container matColumnDef="trfc" >
            <th mat-header-cell *matHeaderCellDef style="padding-left:7%;" class="colorprimary" mat-sort-header sortActionDescription="Sort by trfc"><h6 style="position:relative; top:-9px;">Rfc</h6> </th>
            <td mat-cell *matCellDef="let element" style="text-align: center; padding: 10px;"> 
              {{element.trfc}} 
            </td>
          </ng-container>
          <ng-container matColumnDef="nombres" >
            <th mat-header-cell *matHeaderCellDef style="padding-left:9%;" class="colorprimary" mat-sort-header sortActionDescription="Sort by nombres"><h6 style="position:relative; top:-9px;">Nombre</h6> </th>
            <td mat-cell *matCellDef="let element" style="text-align: center; padding: 10px;"> 
              {{element.nombres}} 
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
          <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"></tr>
        </table>
      </div>
      <mat-paginator #paginator [pageSize]="10" style="background:#423d3d; color:white;" showFirstLastButtons   [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
    </div>
  </div>
  <!-- MOVIL
--------------------------------------------------------------------------------------------------------------------------------------------
-->
  <div class="movil">
    <nav class="navbar navbar-expand-lg colorprimary" >
      <div class="container-fluid" style="align-items: center;">
        <a class="navbar-brand colorprimary" style="padding-left:40%;"><h3>Usuario</h3></a>
      </div> 
      <div style="position: absolute; left:75%;">
        <button style="padding-right:100px" type="button" class="dropdown-item btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor" color="#fff" class="bi bi-h-circle" viewBox="0 0 16 16">
            <path d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8Zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-5-3.998V12H9.67V8.455H6.33V12H5V4.002h1.33v3.322h3.34V4.002H11Z"/>
          </svg>        
        </button>
        <ul class="dropdown-menu">
          <li><button class="dropdown-item" (click)="helpRegistro()">Registrar usuario</button></li>  
          <li><button class="dropdown-item" (click)="helpEditar()">Editar usuario</button></li>  
          <li><button class="dropdown-item" (click)="helpEliminar()">Eliminar usuario</button></li>           
        </ul>
      </div>  
    </nav>
    <div style="padding-left: 1%; padding-right: 1%;  margin-top: 1em">
      <div class="row" style="display: flex; --bs-gutter-x:0rem">
        <div class="col-12" *ngIf="permisos == 'D' || permisos == 'C'">    
          <a type="button" style="min-height:45px; border-radius: 0px; color:white; background:#3f951c; border-color:#285299; border-block-start:none; border-bottom-width:revert; border-left:none;" class="btn col-12" (click)="registrarUsusario()">Registrar</a>
        </div>
      </div> 
      <div class="row">
        <div class="col-12 row mb-2">
          <div class="col-10"></div>
          <!--boton filtro-->
          <div class="col-2 mt-2">
            <button class="btn" (click)="mostrarfiltro()">
              <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
                <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
                  <path d="M747 4469 c-162 -38 -297 -178 -337 -348 -24 -103 4 -245 68 -339 15 -22 363 -410 774 -862 l748 -822 2 -798 c3 -789 3 -799 24 -826 49 -67 130 -91 195 -60 19 9 221 166 449 349 299 239 420 342 432 367 16 32 18 77 18 502 l0 466 663 729 c364 401 707 778 761 838 110 122 151 194 169 300 29 171 -60  360 -214 452 -112 67 11 63 -1944 62 -1002 -1 -1786 -5 -1808 -10z m3580 -326 c50 -23 80 -91 64 -143 -8 -27 -204 -250 -782 -886 -424 -467 -778 -860 -788  -874 -14 -21 -17 -80 -21 -494 l-5 -469 -230 -188 c-126 -103 -233 -188 -237  -188 -5 -1 -8 290 -8 647 -1 591 -2 650 -18 678 -9 18 -361 411 -782 874 -421  463 -773 856 -782 873 -34 60 -15 131 45 167 31 20 64 20 1770 20 1607 0 1742  -1 1774 -17z"/>
                </g>
              </svg>
            </button>
          </div>
          <div style="position:relative;left: 10%;" align="center" class=" row" *ngIf="mostrar == false">
            <form class="was-validated" [formGroup]="reactiveForm" class="card">
              <div class="row" style="justify-content: center; padding-left:4%; padding-right: 4%;">
                <div class="mb-4 col-6 mt-3" style="text-align: center;">
                  <label class="col-12" for="fReferencia" >Estatus</label>
                  <select (click)="filtro(reactiveForm.value.estatus)" [(ngModel)]="reactiveForm.value.estatus" name="select" formControlName="estatus">
                    <option value=""selected></option>
                    <option value="Activo">Activo</option>
                    <option value="Eliminado">Eliminado</option>
                    <option value="Cancelado">Cancelado</option>
                    <option value="Terminado">Terminado</option>
                    <option value="En proceso">En proceso</option>
                  </select>
                </div>
                <div class="mb-4 col-6 mt-3">
                  <label for="fReferencia">RFC</label>
                  <input (keyup)="filtro(reactiveForm.value.trfc)" [(ngModel)]="reactiveForm.value.trfc" formControlName="trfc" class="form-control" id="trfc" placeholder="RFC" >
                </div>
                <div class="mb-4 col-6 mt-3">
                  <label  >Nombre</label>
                  <input (keyup)="filtro(reactiveForm.value.Nombre)" [(ngModel)]="reactiveForm.value.Nombre" formControlName="Nombre" class="form-control" id="Nombre" placeholder="Nombre" >
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="container">
          <div *ngIf="dataSourceMovil" style="overflow-y: auto; min-height: 350px;">
            <table matSort mat-table  [dataSource]="dataSourceMovil"  class="container table table-striped mat-elevation-z8 full-data-table" >    
              <ng-container matColumnDef="E">
                <th mat-header-cell *matHeaderCellDef style="text-align: center;" style=" background:#0146af"><h6 style="position:relative; top:-9px; color:white;">E</h6></th>
                <td mat-cell *matCellDef="let element" style="padding-left: 10px;"> 
                  <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" color="#0146af" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                      <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                    </svg>
                  </button>
                  <ul class="dropdown-menu">
                    <li>
                      <button class="dropdown-item" (click)="DetalleViaje(element!.ecodUsuarios)">Ver detalles</button>
                      <button class="dropdown-item" *ngIf="permisos == 'D' || permisos == 'C'" [disabled]="element!.estatus === 'Eliminado'" class="dropdown-item" (click)="REdireccionarEditarUsurio(element!.ecodUsuarios)">Editar</button>
                      <button class="dropdown-item" *ngIf="permisos == 'D'" [disabled]="element!.estatus === 'Eliminado'" (click)="REdireccionarEliminars(element!.ecodUsuarios)">Eliminar</button>
                    </li>
                  </ul>
                </td>
              </ng-container>
              <ng-container matColumnDef="Nombre">
                <th mat-header-cell *matHeaderCellDef style="text-align: center;" style="color:white; background:#0146af"></th>
                <td mat-cell *matCellDef="let element" style="text-align: center;"> 
                  <mat-expansion-panel class="mat-expansion-panelcliente" hideToggle style="box-shadow:none;color: #0146af;font-size:13px; background:rgba(0,0,0,-1.4);">
                    <hr>
                    <mat-expansion-panel-header style=" padding:0px;">
                      <mat-panel-description style="color: #0146af; font-size:15px; min-width:80%;">{{element.nombres}}</mat-panel-description>
                      <mat-panel-description align="end">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                          <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                        </svg>
                      </mat-panel-description>
                    </mat-expansion-panel-header>
                    RFC: {{element.trfc}}<br>
                    <hr>
                    Estatus:{{element.estatus}} <br>
                    <hr>
                    <div *ngIf="element.fhLlegada!=null AND element.fhSalida!=null ">Fecha de salida: {{element.fhSalida}}<br>Fecha de llegada: {{element.fhLlegada}}</div> 
                  </mat-expansion-panel>  
                </td>
              </ng-container>  
              <tr mat-header-row *matHeaderRowDef="columnsToDisplayMovil"></tr>
              <tr mat-row *matRowDef="let row; columns: columnsToDisplayMovil;"></tr>
            </table>
            <mat-paginator style="background:#423d3d; color:white;" #paginator2 showFirstLastButtons [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
          </div>
        </div> 
      </div>
    </div>
  </div>
</div>